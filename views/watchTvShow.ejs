<% include ./partials/header %>
<%
/* Gets the current date so it can be compared to release date. This should be switched to plain Javascript so the client's time is used. */
var today = new Date();
var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
%>
      <div class="container extra-padding">

        <div class="row ">
          <div class="col">

            <div id="accordion" role="tablist">
              <% for (let i = 1; i < tvInfo.seasons.length; i++){ %>
              <div class="card season-selector">
                <div class="card-header" role="tab" id="headingOne">
                  <h5 class="mb-0">
                    <a data-toggle="collapse" href="#collapse<%= i %>" aria-expanded="true" aria-controls="collapse<%= i %>">
                      Season <%= i %>
                    </a>
                  </h5>
                </div>
                <div id="collapse<%= i %>" class="collapse " role="tabpanel" aria-labelledby="heading<%= i %>" data-parent="#accordion" >
                  <div class="card-body">
                  <ul>
                    <% for (let j = 1; j <= tvInfo.seasons[i].episode_count; j++){%>
                      <% /* NOTE: Indexes start with 1 when it comes to `seasonInfo`, so I needed to subtract 1 from both `i` and `j` */ %>
                    <li><a class="btn <% var releaseDate = new Date(seasonInfo[i - 1].episodes[j - 1].air_date); var todayDate = new Date(date); if (seasonInfo[i - 1].episodes[j - 1].air_date == null || seasonInfo[i - 1].episodes[j - 1].air_date == undefined || todayDate < releaseDate) { %> disabled <% } %>" role="button" <% var releaseDate = new Date(seasonInfo[i - 1].episodes[j - 1].air_date); var todayDate = new Date(date); if (seasonInfo[i - 1].episodes[j - 1].air_date == null || todayDate < releaseDate) { %> aria-disabled="true" <% } %> href="/watch-episode/<%= tvInfo.id %>/<%= i %>/<%= j %>/<%= tvInfo.name %>">S<%= i %>:E<%= j %> <%= seasonInfo[i - 1].episodes[j - 1].name %>  </a></li>
                    <% } %>
                  </div>
                </div>
              </div>
              <% } %>
            </div>
          </div>
          <div class="col">
            <h1><%= tvInfo.name %></h1>
            <p><%= tvInfo.overview %></p>
          </div>
        </div>


    </div>
<style>
body {

  background-image: linear-gradient(to left, rgba(0,0,0,0.9),rgba(0,0,0,0.6)), url(http://image.tmdb.org/t/p/original<%= tvInfo.backdrop_path %>);
  background-position: top;
  background-size: cover;

}

</style>
<% include ./partials/footer %>
